# Section 13: Key Technical Requirements Coverage – Diagrams

This file defines the visuals for Section 13. These diagrams must prove, visually, that every regulator requirement is already covered — IRN, QR, encryption, mapping, hosting, SLA, and integration paths. They should leave the client feeling that compliance is guaranteed by design.

---

## Diagram 32: SmartAPI Services Lifecycle

### Intent
Depict how a single invoice passes through SmartAPI’s compliance services, covering all mandatory regulator requirements (IRN, QR, digital signing, encryption, submission, response, and archiving). The diagram must show step-by-step lifecycle from input to evidence.

### Canvas Layout
Left to right pipeline with sequential service boxes inside the SmartAPI core, regulator on the right, and archive below.

### Elements to Show

**Left Input**
- ERP/Channel input icon cluster: SAP, Oracle, Dynamics, BlueInvoice, Email Connector, BlueBox.
- Label: “Invoice Payload (JSON, XML, IDoc, PDF).”

**SmartAPI Core Pipeline**
- Box sequence inside a larger **SmartAPI Compliance Core** container:
  1. **Transformation** – ERP format normalized into canonical schema.
  2. **Validation** – Schema and business rule checks.
  3. **Reference Mapping** – TIN, HS, tax code, service code cross-check.
  4. **Digital Signing** – PKCS7 signing with HSM-backed keys.
  5. **QR Generation** – IRN + QR payload created.
  6. **Submission** – Sent securely over TLS 1.3 to FIRS.
  7. **Response Handling** – Acknowledgement, clearance, or rejection.
- Side label: *Idempotency + Replay Queue ensure zero invoice loss.*

**Right Output**
- Regulator box: **FIRS MBS**.
- Response arrow back with IRN, QR code, Clearance Receipt.

**Archive Below**
- Evidence Bundle box:
  - Canonical JSON
  - Signed payload
  - IRN + QR
  - Clearance Receipt
  - Audit log extract
- WORM icon with immutability seal, 10-year retention.

### Callouts
- Each step labeled with regulatory requirement it fulfills (e.g., QR generation → FIRS QR mandate).
- Security overlay badges (TLS, AES 256, PKI).

### Style
- Sequential pipeline with clean, bold step icons.
- Blue for SmartAPI processes, green for regulator, navy for archive.

---

## Diagram 33: ERP Integration Decision Tree

### Intent
Provide a high-level decision tree showing how different client ERP environments map to the correct integration method. This reassures CIOs and IT teams that *any environment* has a supported path.

### Canvas Layout
Tree branching from a root “Client ERP Environment” box into four integration choices. Each choice linked to the appropriate Bluelight solution.

### Elements to Show

**Root Node**
- Box labeled “Client ERP Environment.”

**Branch 1: Modern ERP with API Access**
- Examples: SAP S4/HANA, Oracle Fusion, Dynamics 365.
- Path: Direct integration via SmartAPI REST.
- Outcome: “Seamless, real-time integration.”

**Branch 2: SAP ECC Legacy**
- Example: SAP ECC 6.0 with PI/PO middleware.
- Path: SmartAPI via IDoc → PI/PO → REST bridge.
- Outcome: “Preserves ECC while migration-safe for S4.”

**Branch 3: Limited or No ERP Integration**
- Examples: Subsidiaries, contractors, small business units.
- Path: BlueInvoice SaaS or Email Connector.
- Outcome: “Compliance without IT dependency.”

**Branch 4: Legacy/Closed ERPs**
- Example: Custom ERP with print-only output.
- Path: BlueBox Capture Agent → SmartAPI.
- Outcome: “Compliance achieved with zero ERP changes.”

**Final Node**
- All branches converge visually into **SmartAPI Core**.
- SmartAPI Core connects to FIRS MBS.

### Callouts
- Flexible for all maturity levels (modern APIs to legacy print spoolers).
- Migration-safe: ECC → S4 path highlighted in green.
- Reassurance caption: *“No ERP left behind.”*

### Style
- Use decision tree layout with yes/no branch labels where relevant.
- Icons for ERP systems: server, cloud, folder, printer.
- Consistent SmartAPI core hub at the bottom center.
